<dom-module id="cwn-info-link">
    <style>
        span.invalid {
            color: #888;
            font-style: italic;
            vertical-align:super;
        }
        a {
            vertical-align: top;
        }
        :host {
            white-space: nowrap;
            display: inline-block;
        }
    </style>
    <template>
        <span hidden$="{{!valid}}">
            <cwn-app-icon type="{{type}}" width="22" height="22" fillFromType="true"></cwn-app-icon> 
            <a href="{{link}}">{{name}}</a>
        </span>

        <span class="invalid" hidden$="{{valid}}">{{name}}</span>
    </template>
</dom-module>


<script>
    Polymer({
        is : 'cwn-info-link',
        
        properties : {
            name : {
                type : String,
                observer : 'update'
            }
        },

        configure : function() {
            return {
                link : '',
                type : '',
                valid : false,
            }
        },
        
        attached : function() {
            CWN.ds.on('load', this.update.bind(this));
        },

        update : function() {
            if( !CWN.ds.loading ) return;

            if( !CWN.ds.lookupMap[this.name] ) {
                this.valid = false;
                return;
            }

            this.valid = true;
            this.type = CWN.ds.lookupMap[this.name].properties.type;
            this.link = '#info/'+ this.name;
        }

    });
</script>