<!--<polymer-element name="cwn-app-icon" attributes="type width height fillStyle fillFromType">-->
<dom-module id="cwn-app-icon">
    <style>
        cwn-app-icon {
            display: inline-block;
        }
    </style>

    <template>
        <canvas id="canvas"></canvas>
        <i id="icon" class="fa fa-code-fork" style="vertical-align:super"></i>
    </template>
</dom-module>


<script>
    Polymer({
        is: 'cwn-app-icon',

        published : {
            type : String,
            width : String,
            height : String,
            fillStyle : String,
            fillFromType : Boolean
        },

        configure : function() {
            return {
                fillStyle : '#fffff',
                fillFromType : false,
                fontSize : 14,

                styles : {
                  'Power Plant' : '#3366cc',
                  'Agricultural Demand' : '#ff9900',
                  'Junction' : '#109618',
                  'Pump Plant' : '#990099',
                  'Water Treatment' : '#0099c6',
                  'Surface Storage' : '#dd4477',
                  'Urban Demand' : '#66aa00',
                  'Sink' : '#b82e2e',
                  'Groundwater Storage' : '#316395',
                  'Non-Standard Demand' : '#22aa99'
                }
            }
        },

        bind : {
            height : 'redraw',
            width : 'redraw',
            type : 'onTypeChange',
            fontSize : 'onFontSizeChange'
        },

        attached : function() {
            this.redraw();
        },

        onFontSizeChange : function() {
            if( !this.$.icon ) return;

            this.$.icon.style.fontSize = this.fontSize+'px';
        },

        onTypeChange : function() {
            if( this.type == 'Diversion' || this.type == 'Return Flow' ) {
                $(this.$.canvas).hide();
                $(this.$.icon).show();
            } else {
                $(this.$.icon).hide();
                $(this.$.show).show();
            }
            this.redraw();
        },

        redraw : function() {
            if( !this.$.canvas ) return;

            this.fontSize = this.width-15;
            if( this.fontSize < 14 ) this.fontSize = 14;

            this.$.canvas.setAttribute('height', this.height);
            this.$.canvas.setAttribute('width', this.width);

            var ctx = this.$.canvas.getContext('2d');
            ctx.clearRect(0, 0, this.width, this.height);

            if( !CWN.render[this.type] ) return;
            CWN.render[this.type](ctx, 2, 2, this.width-4, this.height-4);
        }
    }); 
</script>